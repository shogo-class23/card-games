<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roen Card Game</title>
    <style>
        :root {
            --fire-color: #FF7B7B;
            --water-color: #7B8CFF;
            --wind-color: #7BFFB8;
            --earth-color: #C19A6B;
            --border-color: #555;
            --field-bg: rgba(0, 0, 0, 0.2);
            --hand-bg: rgba(0, 0, 0, 0.3);
            --card-width: 90px;
            --card-height: 130px;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #3D3D3D;
            color: #F0F0F0;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }

        .game-container {
            width: 100%;
            max-width: 1200px;
            height: 100%;
            display: flex;
            flex-direction: column;
            border: 2px solid var(--border-color);
            background: #4A4A4A;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }

        /* Top and Bottom Areas */
        .opponent-area, .player-area {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        .player-area {
            flex-direction: column-reverse;
        }

        /* Info Bars */
        .info-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px 20px;
            background: rgba(0, 0, 0, 0.2);
        }
        .deck-info, .graveyard-info {
            display: flex;
            align-items: center;
        }
        .deck-info .deck, .graveyard-info .graveyard {
            width: calc(var(--card-width) * 0.7);
            height: calc(var(--card-height) * 0.7);
            border: 2px solid #888;
            border-radius: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            background: #666;
            margin: 0 10px;
        }
        .deck-info span, .graveyard-info span {
            font-size: 14px;
        }
        .opponent-area .deck { order: 1; }
        .opponent-area .deck-label { order: 2; }


        /* Fields */
        .field {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(2, 1fr);
            gap: 10px;
            padding: 10px;
            background: var(--field-bg);
            flex-grow: 1;
            align-items: center;
            justify-items: center;
        }

        /* Center Area */
        .center-area {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px 40px;
            background: rgba(0, 0, 0, 0.4);
            border-top: 1px solid var(--border-color);
            border-bottom: 1px solid var(--border-color);
        }
        .score {
            font-size: 48px;
            font-weight: bold;
        }
        .turn-indicator {
            font-size: 24px;
            font-weight: bold;
            padding: 10px 20px;
            background: var(--fire-color);
            color: white;
            border-radius: 10px;
            box-shadow: 0 0 10px var(--fire-color);
        }

        /* Player Hand */
        .player-hand {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 10px;
            min-height: calc(var(--card-height) + 20px);
            background: var(--hand-bg);
        }
        .player-hand .card {
            margin: 0 -15px;
            transition: transform 0.2s ease, margin 0.2s ease;
        }
        .player-hand .card:hover {
            transform: translateY(-20px) scale(1.1);
            margin: 0 10px;
            z-index: 100;
        }

        /* Card Styling */
        .card-slot {
            width: var(--card-width);
            height: var(--card-height);
            border: 2px dashed #777;
            border-radius: 8px;
            background-color: rgba(255, 255, 255, 0.05);
        }
        .card {
            width: var(--card-width);
            height: var(--card-height);
            border: 2px solid #222;
            border-radius: 8px;
            background-color: #ddd;
            color: #333;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 3px 3px 5px rgba(0,0,0,0.3);
            position: relative;
            user-select: none;
        }
        .card.fire { border-color: var(--fire-color); }
        .card.water { border-color: var(--water-color); }
        .card.wind { border-color: var(--wind-color); }
        .card.earth { border-color: var(--earth-color); }

        .card-header, .card-footer {
            display: flex;
            justify-content: space-between;
            padding: 5px;
            font-size: 18px;
        }
        .card-body {
            text-align: center;
            font-size: 14px;
        }
        .card-body .attribute {
             font-size: 12px;
             padding: 2px 4px;
             border-radius: 4px;
             color: white;
        }
        .fire .attribute { background-color: var(--fire-color); }
        .water .attribute { background-color: var(--water-color); }
        .wind .attribute { background-color: var(--wind-color); }
        .earth .attribute { background-color: var(--earth-color); }

        .status-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 15px;
            background-color: #555;
            border-bottom-left-radius: 6px;
            border-bottom-right-radius: 6px;
            overflow: hidden;
        }
        .hp-bar {
            height: 100%;
            background-color: #32CD32; /* Green */
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            color: white;
            text-shadow: 1px 1px 1px black;
        }
        
        .card.selected {
            transform: scale(1.1);
            border-color: yellow;
            box-shadow: 0 0 15px yellow;
        }

        /* Log Area */
        .log-area {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 250px;
            height: 200px;
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid #666;
            border-radius: 5px;
            padding: 10px;
            font-size: 12px;
            overflow-y: auto;
        }
        .log-area h3 {
            margin: 0 0 10px 0;
            padding-bottom: 5px;
            border-bottom: 1px solid #888;
        }
        .log-area p {
            margin: 0 0 5px 0;
        }
    </style>
</head>
<body>

<div class="game-container">
    <!-- Log Area -->
    <div id="log-area" class="log-area">
        <h3>ゲームログ</h3>
    </div>

    <!-- Opponent's Area -->
    <div class="opponent-area">
        <div id="opponent-field" class="field"></div>
        <div class="info-bar">
            <div id="opponent-graveyard" class="graveyard-info">
                <span class="graveyard-label">墓地: 0</span>
                <div class="graveyard"></div>
            </div>
            <div id="opponent-deck" class="deck-info">
                <div class="deck"></div>
                <span class="deck-label">デッキ: 18/30</span>
            </div>
        </div>
    </div>

    <!-- Center Area -->
    <div class="center-area">
        <div id="opponent-score" class="score">1</div>
        <div class="turn-indicator">あなたの番</div>
        <div id="player-score" class="score">0</div>
    </div>

    <!-- Player's Area -->
    <div class="player-area">
        <div id="player-hand" class="player-hand"></div>
        <div id="player-field" class="field"></div>
        <div class="info-bar">
            <div id="player-deck" class="deck-info">
                 <span class="deck-label">デッキ: 17/30</span>
                <div class="deck"></div>
            </div>
            <div id="player-graveyard" class="graveyard-info">
                <div class="graveyard"></div>
                <span class="graveyard-label">墓地: 0</span>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const SUITS = ['fire', 'water', 'wind', 'earth'];
    const RANKS = ['A', 'K', 'Q', 'J', '9', '8', '6', '4', '3'];
    const RANK_VALUES = { 'A': 14, 'K': 13, 'Q': 12, 'J': 11, '9': 9, '8': 8, '6': 6, '4': 4, '3': 3 };

    class Card {
        constructor(suit, rank) {
            this.id = `${suit}-${rank}-${Math.random()}`;
            this.suit = suit;
            this.rank = rank;
            this.value = RANK_VALUES[rank];
            this.hp = this.value;
            this.maxHp = this.value;
        }
    }

    const state = {
        player: {
            deck: [],
            hand: [],
            field: Array(6).fill(null),
            graveyard: [],
            deckCount: 17,
            totalDeck: 30,
        },
        opponent: {
            deck: [],
            hand: [],
            field: Array(6).fill(null),
            graveyard: [],
            deckCount: 18,
            totalDeck: 30,
        },
        selectedCard: null,
    };

    function createDeck() {
        const deck = [];
        // A full deck would be 30 cards, but for this demo, we just create some examples.
        for (let i = 0; i < 30; i++) {
            const suit = SUITS[Math.floor(Math.random() * SUITS.length)];
            const rank = RANKS[Math.floor(Math.random() * RANKS.length)];
            deck.push(new Card(suit, rank));
        }
        return deck;
    }

    function createCardElement(card, isFaceDown = false) {
        const cardEl = document.createElement('div');
        cardEl.className = `card ${card.suit}`;
        cardEl.dataset.cardId = card.id;

        if (isFaceDown) {
            cardEl.innerHTML = `
                <div class="card-header"></div>
                <div class="card-body" style="font-size: 24px;">?</div>
                <div class="card-footer"></div>
            `;
            cardEl.style.backgroundColor = '#888';
            return cardEl;
        }

        cardEl.innerHTML = `
            <div class="card-header">
                <span>${card.rank}</span>
                <span class="attribute">${card.suit.charAt(0).toUpperCase()}</span>
            </div>
            <div class="card-body">
                <span class="attribute">${card.suit}</span>
            </div>
            <div class="card-footer">
                <span>${card.rank}</span>
            </div>
            <div class="status-bar">
                <div class="hp-bar" style="width: ${(card.hp / card.maxHp) * 100}%">
                    ${card.hp}/${card.maxHp}
                </div>
            </div>
        `;
        return cardEl;
    }

    function addLog(message) {
        const logArea = document.getElementById('log-area');
        const p = document.createElement('p');
        p.textContent = `> ${message}`;
        logArea.appendChild(p);
        logArea.scrollTop = logArea.scrollHeight;
    }
    
    function render() {
        // Render Player Hand
        const playerHandEl = document.getElementById('player-hand');
        playerHandEl.innerHTML = '';
        state.player.hand.forEach(card => {
            const cardEl = createCardElement(card);
            cardEl.addEventListener('click', () => onHandCardClick(card, cardEl));
            playerHandEl.appendChild(cardEl);
        });

        // Render Fields
        renderField('player-field', state.player.field);
        renderField('opponent-field', state.opponent.field);

        // Update Info Panels (static as per requirement)
        document.querySelector('#player-deck .deck-label').textContent = `デッキ: ${state.player.deckCount}/${state.player.totalDeck}`;
        document.querySelector('#player-graveyard .graveyard-label').textContent = `墓地: ${state.player.graveyard.length}`;
        document.querySelector('#opponent-deck .deck-label').textContent = `デッキ: ${state.opponent.deckCount}/${state.opponent.totalDeck}`;
        document.querySelector('#opponent-graveyard .graveyard-label').textContent = `墓地: ${state.opponent.graveyard.length}`;
    }

    function renderField(fieldId, fieldCards) {
        const fieldEl = document.getElementById(fieldId);
        fieldEl.innerHTML = '';
        fieldCards.forEach((card, index) => {
            if (card) {
                const cardEl = createCardElement(card);
                fieldEl.appendChild(cardEl);
            } else {
                const slotEl = document.createElement('div');
                slotEl.className = 'card-slot';
                slotEl.dataset.slotIndex = index;
                if (fieldId === 'player-field') {
                    slotEl.addEventListener('click', () => onSlotClick(index));
                }
                fieldEl.appendChild(slotEl);
            }
        });
    }

    function onHandCardClick(card, cardEl) {
        if (state.selectedCard && state.selectedCard.id === card.id) {
            state.selectedCard = null;
            cardEl.classList.remove('selected');
        } else {
            // Deselect previous
            const prevSelected = document.querySelector('.card.selected');
            if (prevSelected) prevSelected.classList.remove('selected');
            
            state.selectedCard = card;
            cardEl.classList.add('selected');
            addLog(`カード「${card.suit} ${card.rank}」を選択しました。配置する場所を選んでください。`);
        }
    }

    function onSlotClick(index) {
        if (!state.selectedCard) {
            addLog('先に手札から配置するカードを選択してください。');
            return;
        }

        if (state.player.field[index]) {
            addLog('その場所には既にカードが配置されています。');
            return;
        }

        // Place the card
        const cardToPlace = state.selectedCard;
        state.player.field[index] = cardToPlace;

        // Remove from hand
        state.player.hand = state.player.hand.filter(c => c.id !== cardToPlace.id);
        
        state.selectedCard = null;

        addLog(`「${cardToPlace.suit} ${cardToPlace.rank}」をフィールドに配置しました。`);
        render();
    }

    function setupInitialState() {
        // Initial Logs
        addLog("メインフェーズに移行");
        addLog("相手が3体のモンスターを配置");
        addLog("プレイヤーの配置完了"); // This implies player already placed, but we allow placement for demo

        // Setup opponent's field
        const opponentDeck = createDeck();
        state.opponent.field[1] = new Card('fire', '9');
        state.opponent.field[3] = new Card('wind', 'J');
        state.opponent.field[5] = new Card('fire', '8');

        // Setup player's hand
        state.player.hand = [
            new Card('earth', '9'),
            new Card('fire', '6'),
            new Card('fire', '4'),
            new Card('earth', '3'),
            // As per "初期は８枚"
            new Card('water', 'Q'),
            new Card('wind', 'K'),
            new Card('water', 'A'),
            new Card('earth', '8'),
        ];
        
        // Render everything
        render();
    }
    
    // Start the game
    setupInitialState();
});
</script>

</body>
</html>
